{"version":3,"file":"model.js","sourceRoot":"","sources":["../../../../src/project/versioned/v0_3_0/model.ts"],"names":[],"mappings":";AAAA,gEAAgE;AAChE,sCAAsC;;;;;;;;;;;;AAEtC,0CAAsD;AAStD,yDAAmF;AACnF,qDASyB;AACzB,yCAKsB;AAQtB,MAAa,cAAc;CAG1B;AAFC;IAAC,IAAA,0BAAQ,GAAE;;4CACE;AAFf,wCAGC;AAED,MAAa,gBAAgB;CAK5B;AAJC;IAAC,IAAA,0BAAQ,GAAE;;8CACE;AACb;IAAC,IAAA,yBAAO,GAAE;;kDACS;AAJrB,4CAKC;AAED,MAAa,oCAAoC;CAYhD;AAXC;IAAC,IAAA,0BAAQ,GAAE;IACV,IAAA,4BAAU,GAAE;IACZ,IAAA,6BAAS,EAAC,CAAC,EAAC,KAAK,EAAoB,EAAE,EAAE,CAAC,KAAK,CAAC,IAAI,EAAE,CAAC;;qEACxC;AAChB;IAAC,IAAA,wBAAI,EAAC,GAAG,EAAE,CAAC,+BAAsB,CAAC;IAClC,IAAA,4BAAU,GAAE;IACZ,IAAA,gCAAc,EAAC,EAAC,IAAI,EAAE,IAAI,EAAC,CAAC;8BAChB,GAAG;wEAAuB;AACvC;IAAC,IAAA,4BAAU,GAAE;IACZ,IAAA,yBAAO,GAAE;;0EACyB;AAXrC,oFAYC;AAED,MAAa,0BAA2B,SAAQ,oCAAoC;CASnF;AARC;IAAC,IAAA,0BAAQ,GAAE;;4DACM;AACjB;IAAC,IAAA,0BAAQ,GAAE;IACV,IAAA,4BAAU,GAAE;;8DACO;AACpB;IAAC,IAAA,0BAAQ,GAAE;IACV,IAAA,4BAAU,GAAE;;+DACQ;AARvB,gEASC;AAED,MAAa,0BAA2B,SAAQ,sBAAa;CAG5D;AAFC;IAAC,IAAA,0BAAQ,GAAE;;wDACE;AAFf,gEAGC;AAED,MAAa,iCACX,SAAQ,oCAA0E;CAMnF;AAHC;IAAC,IAAA,wBAAI,EAAC,GAAG,EAAE,CAAC,0BAA0B,CAAC;IACtC,IAAA,gCAAc,GAAE;;kEACsC;AANzD,8EAOC;AAED,MAAa,gCAIX,SAAQ,mCAAgC;CACO;AALjD,4EAKiD;AAEjD,MAAa,gBAAgB;CAoB5B;AAnBC;IAAC,IAAA,wBAAM,EAAC,OAAO,CAAC;IACf,IAAA,0BAAQ,GAAE;;qDACS;AACpB;IAAC,IAAA,gCAAc,GAAE;IAChB,IAAA,wBAAI,EAAC,GAAG,EAAE,CAAC,cAAc,CAAC;8BACnB,cAAc;gDAAC;AACvB;IAAC,IAAA,yBAAO,GAAE;IACT,IAAA,gCAAc,GAAE;IAChB,IAAA,wBAAI,EAAC,GAAG,EAAE,CAAC,gCAAgC,EAAE;QAC5C,aAAa,EAAE;YACb,QAAQ,EAAE,MAAM;YAChB,QAAQ,EAAE,CAAC,EAAC,KAAK,EAAE,iCAAiC,EAAE,IAAI,EAAE,gBAAgB,EAAC,CAAC;SAC/E;QACD,yBAAyB,EAAE,IAAI;KAChC,CAAC;;qDACgE;AAClE;IAAC,IAAA,gCAAc,GAAE;IAChB,IAAA,wBAAI,EAAC,GAAG,EAAE,CAAC,oCAAoC,CAAC;8BACxC,oCAAoC;iDAAC;AAnBhD,4CAoBC;AAED,MAAa,yBACX,SAAQ,gCAAyC;IA4BjD,IAAI,UAAU;QACZ,IAAI,CAAC,IAAI,CAAC,WAAW,EAAE;YACrB,IAAI,CAAC,WAAW,GAAG,IAAA,gCAAY,EAAC,gBAAgB,EAAE,IAAI,CAAC,CAAC;YACxD,IAAA,8BAAY,EAAC,IAAI,CAAC,WAAW,EAAE,EAAC,SAAS,EAAE,IAAI,EAAC,CAAC,CAAC;SACnD;QACD,OAAO,IAAI,CAAC,WAAW,CAAC;IAC1B,CAAC;CACF;AAhCC;IAAC,IAAA,wBAAM,EAAC,OAAO,CAAC;;8DACI;AACpB;IAAC,IAAA,0BAAQ,GAAE;;uDACE;AACb;IAAC,IAAA,0BAAQ,GAAE;;0DACK;AAChB;IAAC,IAAA,0BAAQ,GAAE;IACV,IAAA,gCAAc,GAAE;IAChB,IAAA,wBAAI,EAAC,GAAG,EAAE,CAAC,0BAA0B,CAAC;8BAC9B,0BAA0B;0DAAC;AACpC;IAAC,IAAA,gCAAc,GAAE;IAChB,IAAA,wBAAI,EAAC,GAAG,EAAE,CAAC,cAAc,CAAC;8BACnB,cAAc;yDAAC;AACvB;IAAC,IAAA,yBAAO,GAAE;IACT,IAAA,gCAAc,GAAE;IAChB,IAAA,wBAAI,EAAC,GAAG,EAAE,CAAC,gCAAgC,EAAE;QAC5C,aAAa,EAAE;YACb,QAAQ,EAAE,MAAM;YAChB,QAAQ,EAAE,CAAC,EAAC,KAAK,EAAE,iCAAiC,EAAE,IAAI,EAAE,gBAAgB,EAAC,CAAC;SAC/E;QACD,yBAAyB,EAAE,IAAI;KAChC,CAAC;;8DACgE;AA1BpE,8DAoCC","sourcesContent":["// Copyright 2020-2022 OnFinality Limited authors & contributors\n// SPDX-License-Identifier: Apache-2.0\n\nimport {ProjectManifestBaseImpl} from '@subql/common';\nimport {\n  SubqlCosmosCustomDatasource,\n  SubqlCosmosCustomHandler,\n  SubqlCosmosMapping,\n  SubqlCosmosRuntimeHandler,\n  CustomModule,\n} from '@subql/types-cosmos';\n\nimport {plainToClass, Transform, TransformFnParams, Type} from 'class-transformer';\nimport {\n  Equals,\n  IsArray,\n  IsNotEmpty,\n  IsObject,\n  IsOptional,\n  IsString,\n  ValidateNested,\n  validateSync,\n} from 'class-validator';\nimport {\n  CosmosCustomDataSourceBase,\n  CosmosRuntimeDataSourceBase,\n  CosmosMapping,\n  CosmosCustomModuleImpl,\n} from '../../models';\nimport {\n  CustomDatasourceV0_3_0,\n  CosmosProjectManifestV0_3_0,\n  RuntimeDataSourceV0_3_0,\n  SubqlMappingV0_3_0,\n} from './types';\n\nexport class FileTypeV0_3_0 {\n  @IsString()\n  file: string;\n}\n\nexport class CustomModuleImpl implements CustomModule {\n  @IsString()\n  file: string;\n  @IsArray()\n  messages: string[];\n}\n\nexport class CosmosProjectNetworkDeploymentV0_3_0 {\n  @IsString()\n  @IsNotEmpty()\n  @Transform(({value}: TransformFnParams) => value.trim())\n  chainId: string;\n  @Type(() => CosmosCustomModuleImpl)\n  @IsOptional()\n  @ValidateNested({each: true})\n  chainTypes?: Map<string, CustomModule>;\n  @IsOptional()\n  @IsArray()\n  bypassBlocks?: (number | string)[];\n}\n\nexport class CosmosProjectNetworkV0_3_0 extends CosmosProjectNetworkDeploymentV0_3_0 {\n  @IsString()\n  endpoint: string;\n  @IsString()\n  @IsOptional()\n  dictionary?: string;\n  @IsString()\n  @IsOptional()\n  genesisHash?: string;\n}\n\nexport class CosmosProjectMappingV0_3_0 extends CosmosMapping {\n  @IsString()\n  file: string;\n}\n\nexport class CosmosRuntimeDataSourceV0_3_0Impl\n  extends CosmosRuntimeDataSourceBase<SubqlMappingV0_3_0<SubqlCosmosRuntimeHandler>>\n  implements RuntimeDataSourceV0_3_0\n{\n  @Type(() => CosmosProjectMappingV0_3_0)\n  @ValidateNested()\n  mapping: SubqlMappingV0_3_0<SubqlCosmosRuntimeHandler>;\n}\n\nexport class CosmosCustomDataSourceV0_3_0Impl<\n    K extends string = string,\n    M extends SubqlCosmosMapping = SubqlCosmosMapping<SubqlCosmosCustomHandler>\n  >\n  extends CosmosCustomDataSourceBase<K, M>\n  implements SubqlCosmosCustomDatasource<K, M> {}\n\nexport class DeploymentV0_3_0 {\n  @Equals('0.3.0')\n  @IsString()\n  specVersion: string;\n  @ValidateNested()\n  @Type(() => FileTypeV0_3_0)\n  schema: FileTypeV0_3_0;\n  @IsArray()\n  @ValidateNested()\n  @Type(() => CosmosCustomDataSourceV0_3_0Impl, {\n    discriminator: {\n      property: 'kind',\n      subTypes: [{value: CosmosRuntimeDataSourceV0_3_0Impl, name: 'cosmos/Runtime'}],\n    },\n    keepDiscriminatorProperty: true,\n  })\n  dataSources: (RuntimeDataSourceV0_3_0 | CustomDatasourceV0_3_0)[];\n  @ValidateNested()\n  @Type(() => CosmosProjectNetworkDeploymentV0_3_0)\n  network: CosmosProjectNetworkDeploymentV0_3_0;\n}\n\nexport class ProjectManifestV0_3_0Impl\n  extends ProjectManifestBaseImpl<DeploymentV0_3_0>\n  implements CosmosProjectManifestV0_3_0\n{\n  @Equals('0.3.0')\n  specVersion: string;\n  @IsString()\n  name: string;\n  @IsString()\n  version: string;\n  @IsObject()\n  @ValidateNested()\n  @Type(() => CosmosProjectNetworkV0_3_0)\n  network: CosmosProjectNetworkV0_3_0;\n  @ValidateNested()\n  @Type(() => FileTypeV0_3_0)\n  schema: FileTypeV0_3_0;\n  @IsArray()\n  @ValidateNested()\n  @Type(() => CosmosCustomDataSourceV0_3_0Impl, {\n    discriminator: {\n      property: 'kind',\n      subTypes: [{value: CosmosRuntimeDataSourceV0_3_0Impl, name: 'cosmos/Runtime'}],\n    },\n    keepDiscriminatorProperty: true,\n  })\n  dataSources: (RuntimeDataSourceV0_3_0 | CustomDatasourceV0_3_0)[];\n  protected _deployment: DeploymentV0_3_0;\n\n  get deployment(): DeploymentV0_3_0 {\n    if (!this._deployment) {\n      this._deployment = plainToClass(DeploymentV0_3_0, this);\n      validateSync(this._deployment, {whitelist: true});\n    }\n    return this._deployment;\n  }\n}\n"]}