{"version":3,"file":"local-reader.js","sourceRoot":"","sources":["../../../src/project/readers/local-reader.ts"],"names":[],"mappings":";AAAA,gEAAgE;AAChE,sCAAsC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAEtC,uCAAyB;AACzB,2CAA6B;AAC7B,sDAA2B;AAI3B,MAAa,WAAW;IACtB,YAA6B,WAAmB,EAAmB,YAAoB;QAA1D,gBAAW,GAAX,WAAW,CAAQ;QAAmB,iBAAY,GAAZ,YAAY,CAAQ;IAAG,CAAC;IAE3F,IAAI,IAAI;QACN,OAAO,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC;IACxC,CAAC;IAED,KAAK,CAAC,MAAM;QACV,OAAO,iBAAI,CAAC,IAAI,CAAC,MAAM,IAAI,CAAC,OAAO,CAAC,cAAc,CAAC,CAAiB,CAAC;IACvE,CAAC;IAED,KAAK,CAAC,gBAAgB;QACpB,IAAI,CAAC,EAAE,CAAC,UAAU,CAAC,IAAI,CAAC,YAAY,CAAC,EAAE;YACrC,OAAO,OAAO,CAAC,OAAO,CAAC,SAAS,CAAC,CAAC;SACnC;QACD,OAAO,iBAAI,CAAC,IAAI,CAAC,EAAE,CAAC,YAAY,CAAC,IAAI,CAAC,YAAY,EAAE,OAAO,CAAC,CAAC,CAAC;IAChE,CAAC;IAED,KAAK,CAAC,OAAO,CAAC,QAAgB;QAC5B,MAAM,IAAI,GAAG,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,WAAW,EAAE,QAAQ,CAAC,CAAC;QACtD,IAAI,CAAC,EAAE,CAAC,UAAU,CAAC,IAAI,CAAC,EAAE;YACxB,OAAO,OAAO,CAAC,OAAO,CAAC,SAAS,CAAC,CAAC;SACnC;QACD,IAAI;YACF,OAAO,EAAE,CAAC,YAAY,CAAC,IAAI,EAAE,OAAO,CAAC,CAAC;SACvC;QAAC,OAAO,CAAC,EAAE;YACV,OAAO,SAAS,CAAC;SAClB;IACH,CAAC;CACF;AA7BD,kCA6BC","sourcesContent":["// Copyright 2020-2022 OnFinality Limited authors & contributors\n// SPDX-License-Identifier: Apache-2.0\n\nimport * as fs from 'fs';\nimport * as path from 'path';\nimport yaml from 'js-yaml';\nimport {IPackageJson} from 'package-json-type';\nimport {Reader} from './reader';\n\nexport class LocalReader implements Reader {\n  constructor(private readonly projectPath: string, private readonly manifestPath: string) {}\n\n  get root(): string {\n    return path.resolve(this.projectPath);\n  }\n\n  async getPkg(): Promise<IPackageJson | undefined> {\n    return yaml.load(await this.getFile('package.json')) as IPackageJson;\n  }\n\n  async getProjectSchema(): Promise<unknown | undefined> {\n    if (!fs.existsSync(this.manifestPath)) {\n      return Promise.resolve(undefined);\n    }\n    return yaml.load(fs.readFileSync(this.manifestPath, 'utf-8'));\n  }\n\n  async getFile(fileName: string): Promise<string | undefined> {\n    const file = path.resolve(this.projectPath, fileName);\n    if (!fs.existsSync(file)) {\n      return Promise.resolve(undefined);\n    }\n    try {\n      return fs.readFileSync(file, 'utf-8');\n    } catch (e) {\n      return undefined;\n    }\n  }\n}\n"]}